<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Perfect - Premium Luxury E-Commerce</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #131921;
            --secondary: #232f3e;
            --gold: #d4af37;
            --gold-light: #c9a961;
            --text-primary: #fff;
            --text-secondary: #b0b0b0;
            --bg-light: #f8f8f8;
            --border: #404855;
            --success: #31a24c;
            --warning: #ff9500;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', sans-serif;
            background-color: var(--primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .page { display: none; }
        .page.active { display: block; }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--secondary);
            border: 2px solid var(--gold);
            border-radius: 4px;
            padding: 25px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }

        .modal-header h2 {
            color: var(--gold);
            font-size: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 28px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-close:hover {
            color: var(--gold);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: var(--gold);
            margin-bottom: 6px;
            font-size: 13px;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            background: var(--primary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            border-radius: 3px;
            font-family: inherit;
            font-size: 13px;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 8px rgba(212, 175, 55, 0.3);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .btn-primary {
            background: var(--gold);
            color: #111;
            padding: 10px 20px;
            border: none;
            border-radius: 3px;
            font-weight: 700;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            width: 100%;
        }

        .btn-primary:hover {
            background: var(--gold-light);
        }

        .btn-secondary {
            background: var(--border);
            color: var(--text-primary);
            padding: 8px 16px;
            border: none;
            border-radius: 3px;
            font-weight: 700;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
            margin-right: 8px;
        }

        .btn-secondary:hover {
            background: #555;
        }

        .image-preview {
            width: 100%;
            height: 150px;
            background-size: cover;
            background-position: center;
            border: 2px dashed var(--gold);
            border-radius: 4px;
            margin-top: 10px;
            display: none;
        }

        .image-preview.show {
            display: block;
        }

        input[type="file"] {
            padding: 10px;
            background: var(--primary);
            border: 2px dashed var(--gold);
            color: var(--text-primary);
            border-radius: 3px;
            cursor: pointer;
            width: 100%;
            font-size: 12px;
        }

        input[type="file"]::file-selector-button {
            background: var(--gold);
            color: #111;
            border: none;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: 700;
            margin-right: 10px;
        }

        input[type="file"]::file-selector-button:hover {
            background: var(--gold-light);
        }

        .admin-product-item {
            background: var(--primary);
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 3px;
            border: 1px solid var(--border);
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .admin-product-image {
            width: 80px;
            height: 80px;
            background-size: cover;
            background-position: center;
            border-radius: 3px;
            border: 1px solid var(--gold);
            flex-shrink: 0;
        }

        .admin-product-info {
            flex: 1;
        }

        .admin-product-name {
            color: var(--gold);
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .admin-product-details {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .admin-product-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn-edit {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 700;
            transition: all 0.2s;
        }

        .btn-edit:hover {
            background: #45a049;
        }

        .btn-delete {
            background: #ff3333;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 700;
            transition: all 0.2s;
        }

        .btn-delete:hover {
            background: #cc0000;
        }

        .header-top {
            background: var(--primary);
            border-bottom: 1px solid var(--border);
            padding: 10px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(212, 175, 55, 0.2);
        }

        .header-top-content {
            max-width: 1500px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 20px;
            justify-content: space-between;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 200px;
        }

        .logo-img {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid var(--gold);
            object-fit: cover;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 700;
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .search-container {
            flex: 1;
            display: flex;
            align-items: center;
            background: var(--text-primary);
            border-radius: 4px;
            height: 38px;
            max-width: 500px;
        }

        .search-container input {
            flex: 1;
            border: none;
            padding: 8px 12px;
            background: transparent;
            color: #111;
            font-size: 14px;
        }

        .search-container input::placeholder {
            color: #999;
        }

        .search-container input:focus {
            outline: none;
        }

        .search-btn {
            background: var(--gold);
            border: none;
            color: #111;
            padding: 0 15px;
            cursor: pointer;
            height: 100%;
            border-radius: 0 4px 4px 0;
            font-weight: 700;
            transition: all 0.2s;
        }

        .search-btn:hover {
            background: var(--gold-light);
        }

        .header-right {
            display: flex;
            gap: 15px;
            align-items: center;
            min-width: 250px;
            justify-content: flex-end;
        }

        .header-link {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 12px;
            padding: 5px 10px;
            border-right: 1px solid var(--border);
            transition: all 0.2s;
            cursor: pointer;
        }

        .header-link:hover {
            color: var(--gold);
        }

        .header-link:last-child {
            border-right: none;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 28px;
        }

        .cart-badge {
            position: absolute;
            top: -10px;
            right: -5px;
            background: var(--warning);
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
        }

        .navbar {
            background: var(--secondary);
            border-bottom: 1px solid var(--border);
            padding: 0;
            overflow-x: auto;
        }

        .navbar-content {
            max-width: 1500px;
            margin: 0 auto;
            display: flex;
            gap: 0;
            align-items: center;
            padding: 0 20px;
            list-style: none;
        }

        .nav-item {
            padding: 12px 15px;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .nav-item:hover {
            border-bottom-color: var(--gold);
            color: var(--gold);
        }

        .banner {
            background: linear-gradient(135deg, #000 0%, #1a1a1a 100%);
            padding: 50px 20px;
            text-align: center;
            border-bottom: 2px solid var(--gold);
        }

        .banner-content {
            max-width: 1500px;
            margin: 0 auto;
        }

        .banner h1 {
            font-size: 42px;
            color: var(--gold);
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        .banner p {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .main-container {
            max-width: 1500px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: var(--secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 15px;
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .sidebar h3 {
            color: var(--gold);
            font-size: 14px;
            margin-bottom: 12px;
            font-weight: 700;
            text-transform: uppercase;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
        }

        .filter-group {
            margin-bottom: 20px;
        }

        .filter-group-title {
            color: var(--gold);
            font-size: 12px;
            margin-bottom: 10px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            font-size: 12px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .filter-option:hover {
            color: var(--gold);
        }

        .filter-option input[type="checkbox"] {
            cursor: pointer;
            width: 16px;
            height: 16px;
            accent-color: var(--gold);
        }

        .filter-option label {
            cursor: pointer;
        }

        .products-section {
            background: var(--secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 20px;
        }

        .section-title {
            color: var(--gold);
            font-size: 16px;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
        }

        .product-item {
            background: var(--primary);
            border: 1px solid var(--border);
            border-radius: 4px;
            overflow: hidden;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            cursor: pointer;
        }

        .product-item:hover {
            border-color: var(--gold);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 150px;
            background-size: cover;
            background-position: center;
            background-color: #333;
        }

        .product-body {
            padding: 12px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .product-name {
            font-size: 12px;
            color: var(--text-primary);
            margin-bottom: 6px;
            line-height: 1.3;
            height: 30px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .product-rating {
            font-size: 11px;
            color: var(--warning);
            margin-bottom: 8px;
        }

        .product-price {
            font-size: 16px;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 8px;
        }

        .product-buttons {
            display: flex;
            gap: 6px;
            margin-top: auto;
        }

        .btn-add-cart {
            flex: 1;
            background: var(--gold);
            color: #111;
            border: none;
            padding: 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-add-cart:hover {
            background: var(--gold-light);
        }

        .btn-buy-now {
            flex: 1;
            background: var(--warning);
            color: white;
            border: none;
            padding: 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-buy-now:hover {
            background: #ff7d00;
        }

        .product-detail-page {
            background: var(--primary);
            min-height: 100vh;
        }

        .detail-header {
            background: var(--secondary);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 15px;
            position: sticky;
            top: 0;
            z-index: 500;
        }

        .back-btn {
            background: var(--gold);
            color: #111;
            border: none;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background: var(--gold-light);
        }

        .detail-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .detail-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            background: var(--secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .detail-image {
            width: 100%;
            height: 400px;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            border: 2px solid var(--border);
        }

        .detail-info h1 {
            font-size: 28px;
            color: var(--gold);
            margin-bottom: 15px;
        }

        .detail-rating {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .stars {
            color: var(--warning);
            font-size: 16px;
        }

        .review-count {
            color: var(--text-secondary);
        }

        .detail-price {
            font-size: 32px;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }

        .detail-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .detail-category {
            background: var(--primary);
            padding: 10px 15px;
            border-radius: 3px;
            margin-bottom: 20px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .detail-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .btn-primary-action {
            background: var(--gold);
            color: #111;
            border: none;
            padding: 12px 25px;
            border-radius: 3px;
            font-weight: 700;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            flex: 1;
        }

        .btn-primary-action:hover {
            background: var(--gold-light);
        }

        .btn-secondary-action {
            background: var(--warning);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 3px;
            font-weight: 700;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            flex: 1;
        }

        .btn-secondary-action:hover {
            background: #ff7d00;
        }

        .reviews-section {
            background: var(--secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .reviews-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }

        .reviews-header h2 {
            color: var(--gold);
            font-size: 20px;
        }

        .rating-summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .rating-box {
            background: var(--primary);
            padding: 15px;
            border-radius: 4px;
            text-align: center;
        }

        .rating-score {
            font-size: 36px;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 5px;
        }

        .rating-stars {
            font-size: 16px;
            color: var(--warning);
            margin-bottom: 5px;
        }

        .rating-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .add-review-form {
            background: var(--primary);
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .add-review-form h3 {
            color: var(--gold);
            font-size: 14px;
            margin-bottom: 12px;
        }

        .review-item {
            background: var(--primary);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 12px;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            align-items: center;
        }

        .reviewer-name {
            color: var(--gold);
            font-weight: 700;
            font-size: 13px;
        }

        .review-date {
            color: var(--text-secondary);
            font-size: 11px;
        }

        .review-stars {
            color: var(--warning);
            font-size: 12px;
            margin-bottom: 8px;
        }

        .review-text {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
        }

        .footer {
            background: var(--primary);
            border-top: 1px solid var(--border);
            padding: 40px 20px;
            margin-top: 40px;
        }

        .footer-content {
            max-width: 1500px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .footer-col h4 {
            color: var(--gold);
            font-size: 13px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .footer-col ul {
            list-style: none;
        }

        .footer-col li {
            margin-bottom: 6px;
        }

        .footer-col a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
            transition: all 0.2s;
        }

        .footer-col a:hover {
            color: var(--gold);
        }

        .footer-bottom {
            border-top: 1px solid var(--border);
            padding-top: 20px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 12px;
        }

        .admin-btn {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gold);
            color: #111;
            border: none;
            cursor: pointer;
            font-size: 22px;
            font-weight: 700;
            z-index: 999;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
            transition: all 0.3s;
        }

        .admin-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(212, 175, 55, 0.6);
        }

        .tabs {
            display: flex;
            gap: 0;
            border-bottom: 2px solid var(--border);
            margin-bottom: 20px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            background: var(--primary);
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }

        .tab-btn.active {
            color: var(--gold);
            border-bottom-color: var(--gold);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--gold);
            color: #111;
            padding: 12px 20px;
            border-radius: 3px;
            z-index: 3000;
            font-weight: 700;
            font-size: 13px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @media (max-width: 1024px) {
            .main-container { grid-template-columns: 1fr; }
            .sidebar { display: none; }
            .products-grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
            .detail-content { grid-template-columns: 1fr; }
            .rating-summary { grid-template-columns: 1fr; }
        }

        @media (max-width: 768px) {
            .header-top-content { flex-wrap: wrap; }
            .search-container { order: 3; flex-basis: 100%; margin-top: 10px; }
            .products-grid { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }
            .banner h1 { font-size: 28px; }
            .detail-content { grid-template-columns: 1fr; padding: 15px; }
            .detail-image { height: 300px; }
            .detail-info h1 { font-size: 22px; }
            .detail-price { font-size: 24px; }
        }

        @media (max-width: 480px) {
            .products-grid { grid-template-columns: 1fr; }
            .nav-item { padding: 10px 12px; font-size: 12px; }
            .main-container { padding: 10px; }
            .modal-content { max-width: 95%; }
        }
    </style>
</head>
<body>

<!-- HOME PAGE -->
<div id="homePage" class="page active">
    <div class="header-top">
        <div class="header-top-content">
            <div class="logo-section">
                <img src="https://agi-prod-file-upload-public-main-use1.s3.amazonaws.com/4c5bf2f5-163f-4de2-9a92-2957ec6ecf83" alt="Royal Perfect" class="logo-img">
                <div class="logo-text">Royal Perfect</div>
            </div>
            <div class="search-container">
                <input type="text" id="searchBox" placeholder="Search jewelry, sarees, dresses..." onkeyup="searchProducts()">
                <button class="search-btn" onclick="searchProducts()">Search</button>
            </div>
            <div class="header-right">
                <div class="header-link" onclick="openAdminModal()">‚öôÔ∏è Admin</div>
                <div class="header-link" id="userLink" onclick="openUserPanel()">üë§ Sign In</div>
                <div class="cart-icon">üõí<span class="cart-badge" id="cartBadge">0</span></div>
            </div>
        </div>
    </div>

    <div class="navbar">
        <div class="navbar-content">
            <div class="nav-item" onclick="filterByCategory('all')">All</div>
            <div class="nav-item" onclick="filterByCategory('jewelry')">üíé Jewelry</div>
            <div class="nav-item" onclick="filterByCategory('sarees')">üëó Sarees</div>
            <div class="nav-item" onclick="filterByCategory('dresses')">üë† Dresses</div>
            <div class="nav-item" onclick="filterByCategory('accessories')">‚ú® Accessories</div>
        </div>
    </div>

    <div class="banner">
        <div class="banner-content">
            <h1>‚ú® Royal Perfect Premium Luxury ‚ú®</h1>
            <p>Authentic Jewelry ‚Ä¢ Designer Sarees ‚Ä¢ Elegant Dresses ‚Ä¢ Premium Accessories</p>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <h3>üîç Filters</h3>
            <div class="filter-group">
                <div class="filter-group-title">Price Range</div>
                <div class="filter-option"><input type="checkbox" id="price1" onchange="applyFilters()"><label for="price1">Under ‚Çπ2,000</label></div>
                <div class="filter-option"><input type="checkbox" id="price2" onchange="applyFilters()"><label for="price2">‚Çπ2,000 - ‚Çπ5,000</label></div>
                <div class="filter-option"><input type="checkbox" id="price3" onchange="applyFilters()"><label for="price3">‚Çπ5,000 - ‚Çπ10,000</label></div>
                <div class="filter-option"><input type="checkbox" id="price4" onchange="applyFilters()"><label for="price4">Above ‚Çπ10,000</label></div>
            </div>
            <div class="filter-group">
                <div class="filter-group-title">Category</div>
                <div class="filter-option"><input type="checkbox" id="cat1" onchange="applyFilters()"><label for="cat1">üíé Jewelry</label></div>
                <div class="filter-option"><input type="checkbox" id="cat2" onchange="applyFilters()"><label for="cat2">üëó Sarees</label></div>
                <div class="filter-option"><input type="checkbox" id="cat3" onchange="applyFilters()"><label for="cat3">üë† Dresses</label></div>
                <div class="filter-option"><input type="checkbox" id="cat4" onchange="applyFilters()"><label for="cat4">‚ú® Accessories</label></div>
            </div>
            <div class="filter-group">
                <div class="filter-group-title">Rating</div>
                <div class="filter-option"><input type="checkbox" id="rating5" onchange="applyFilters()"><label for="rating5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 Star</label></div>
                <div class="filter-option"><input type="checkbox" id="rating4" onchange="applyFilters()"><label for="rating4">‚≠ê‚≠ê‚≠ê‚≠ê 4+ Star</label></div>
                <div class="filter-option"><input type="checkbox" id="rating3" onchange="applyFilters()"><label for="rating3">‚≠ê‚≠ê‚≠ê 3+ Star</label></div>
            </div>
            <button class="btn-primary" onclick="clearFilters()" style="width: 100%; margin-top: 15px;">Clear Filters</button>
        </div>
        <div>
            <div class="products-section">
                <h2 class="section-title">Featured Products</h2>
                <div class="products-grid" id="productsGrid"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-content">
            <div class="footer-col">
                <h4>Contact Info</h4>
                <ul>
                    <li>üì± WhatsApp: 8220390911</li>
                    <li>üìß Email: royalperfect2002@gmail.com</li>
                    <li>üìç Chennai, India</li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Policies</a></li>
                    <li><a href="#">FAQs</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">¬© 2025 Royal Perfect. All Rights Reserved.</div>
    </div>
</div>

<!-- PRODUCT DETAIL PAGE -->
<div id="productDetailPage" class="page product-detail-page">
    <div class="detail-header">
        <button class="back-btn" onclick="goHome()">‚Üê Back</button>
        <h2 id="detailTitle" style="flex: 1; color: var(--gold); margin: 0;"></h2>
    </div>

    <div class="detail-container">
        <div class="detail-content">
            <div class="detail-image" id="detailImage"></div>
            <div class="detail-info">
                <h1 id="detailName"></h1>
                <div class="detail-rating">
                    <span class="stars" id="detailStars"></span>
                    <span class="review-count" id="detailReviewCount"></span>
                </div>
                <div class="detail-price" id="detailPrice"></div>
                <div class="detail-category" id="detailCategory"></div>
                <div class="detail-desc" id="detailDesc"></div>
                <div class="detail-actions">
                    <button class="btn-primary-action" onclick="addToCart()">üõí Add to Cart</button>
                    <button class="btn-secondary-action" onclick="buyNow()">üí≥ Buy Now</button>
                </div>
            </div>
        </div>

        <div class="reviews-section">
            <div class="reviews-header">
                <h2>‚≠ê Reviews & Ratings</h2>
            </div>

            <div class="rating-summary">
                <div class="rating-box">
                    <div class="rating-score" id="avgRating">5.0</div>
                    <div class="rating-stars" id="summaryStars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    <div class="rating-label">Average Rating</div>
                </div>
                <div class="rating-box">
                    <div class="rating-score" id="totalReviews">0</div>
                    <div class="rating-label">Total Reviews</div>
                </div>
            </div>

            <div class="add-review-form">
                <h3>‚úçÔ∏è Add Your Review</h3>
                <div class="form-group">
                    <label>Your Name</label>
                    <input type="text" id="reviewName" placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label>Rating (1-5 stars)</label>
                    <select id="reviewRating">
                        <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent (5)</option>
                        <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Good (4)</option>
                        <option value="3">‚≠ê‚≠ê‚≠ê Average (3)</option>
                        <option value="2">‚≠ê‚≠ê Poor (2)</option>
                        <option value="1">‚≠ê Very Poor (1)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Your Review</label>
                    <textarea id="reviewText" placeholder="Share your experience..."></textarea>
                </div>
                <button class="btn-primary" onclick="submitReview()" style="margin-top: 10px;">Post Review</button>
            </div>

            <div id="reviewsList"></div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-bottom">¬© 2025 Royal Perfect. All Rights Reserved.</div>
    </div>
</div>

<!-- USER LOGIN/SIGNUP MODAL -->
<div id="userModal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <div class="modal-header">
            <h2>üë§ Account</h2>
            <button class="modal-close" onclick="closeUserPanel()">‚úï</button>
        </div>

        <div class="tabs" id="authTabs">
            <button class="tab-btn active" onclick="switchTab('login')">Sign In</button>
            <button class="tab-btn" onclick="switchTab('signup')">Sign Up</button>
        </div>

        <div id="loginTab" class="tab-content active">
            <div class="form-group">
                <label>üì± Mobile Number</label>
                <input type="tel" id="loginMobile" placeholder="10-digit mobile number" maxlength="10">
            </div>
            <div class="form-group">
                <label>üîê Password</label>
                <input type="password" id="loginPassword" placeholder="Enter password" onkeypress="if(event.key==='Enter') loginUser()">
            </div>
            <button class="btn-primary" onclick="loginUser()">Sign In</button>
        </div>

        <div id="signupTab" class="tab-content">
            <div class="form-group">
                <label>üë§ Full Name</label>
                <input type="text" id="signupName" placeholder="Your name">
            </div>
            <div class="form-group">
                <label>üì± Mobile Number</label>
                <input type="tel" id="signupMobile" placeholder="10-digit mobile number" maxlength="10">
            </div>
            <div class="form-group">
                <label>üìß Email (Optional)</label>
                <input type="email" id="signupEmail" placeholder="your@email.com">
            </div>
            <div class="form-group">
                <label>üîê Password</label>
                <input type="password" id="signupPassword" placeholder="Create password" onkeypress="if(event.key==='Enter') signupUser()">
            </div>
            <button class="btn-primary" onclick="signupUser()">Create Account</button>
        </div>

        <div id="accountTab" class="tab-content">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 24px; margin-bottom: 8px;">üë§</div>
                <div id="accountName" style="color: var(--gold); font-weight: 700; margin-bottom: 4px;"></div>
                <div id="accountMobile" style="color: var(--text-secondary); font-size: 12px;"></div>
            </div>

            <div class="form-group">
                <label>üìù Full Address</label>
                <textarea id="accountAddress" placeholder="Enter your address" style="resize: vertical; min-height: 80px;"></textarea>
            </div>
            <div class="form-group-row">
                <div><label>üèôÔ∏è City</label><input type="text" id="accountCity" placeholder="City"></div>
                <div><label>üìÆ Pincode</label><input type="text" id="accountPincode" placeholder="Pincode"></div>
            </div>
            <div class="form-group-row">
                <div><label>üåç State</label><input type="text" id="accountState" placeholder="State"></div>
                <div><label>üáÆüá≥ Country</label><input type="text" id="accountCountry" placeholder="Country" value="India"></div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-primary" onclick="saveAccountDetails()" style="flex: 1;">üíæ Save Details</button>
                <button class="btn-secondary" onclick="logoutUser()" style="flex: 1;">üö™ Logout</button>
            </div>
        </div>
    </div>
</div>

<!-- ADMIN MODAL -->
<div id="adminModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>‚öôÔ∏è Admin Panel</h2>
            <button class="modal-close" onclick="closeAdminModal()">‚úï</button>
        </div>

        <div id="adminPasswordSection">
            <div class="form-group">
                <label>üîê Admin Password</label>
                <input type="password" id="adminPass" placeholder="Enter password" onkeypress="if(event.key==='Enter') verifyAdmin()">
            </div>
            <button class="btn-primary" onclick="verifyAdmin()">Access Admin Panel</button>
        </div>

        <div id="adminContent" style="display: none;">
            <h3 style="color: var(--gold); margin: 20px 0 15px 0;">üì¶ Add New Product</h3>
            <div class="form-group">
                <label>üìù Product Name</label>
                <input type="text" id="newProdName" placeholder="Product name">
            </div>
            <div class="form-group">
                <label>üí∞ Price (‚Çπ)</label>
                <input type="number" id="newProdPrice" placeholder="Price" min="0">
            </div>
            <div class="form-group">
                <label>üìÇ Category</label>
                <select id="newProdCategory">
                    <option value="jewelry">Jewelry</option>
                    <option value="sarees">Sarees</option>
                    <option value="dresses">Dresses</option>
                    <option value="accessories">Accessories</option>
                </select>
            </div>
            <div class="form-group">
                <label>üìÑ Description</label>
                <textarea id="newProdDesc" placeholder="Product description (optional)"></textarea>
            </div>
            <div class="form-group">
                <label>üìÅ Upload Image</label>
                <input type="file" id="newProdImage" accept="image/*" onchange="previewNewImage(this)">
                <div class="image-preview" id="newImagePreview"></div>
            </div>
            <button class="btn-primary" onclick="addProduct()">‚úÖ Add Product</button>

            <div id="editProductSection" style="display: none; margin-top: 30px; border-top: 2px solid var(--border); padding-top: 20px;">
                <h3 style="color: var(--gold); margin-bottom: 15px;">‚úèÔ∏è Edit Product</h3>
                <div class="form-group"><label>üìù Product Name</label><input type="text" id="editProdName" placeholder="Product name"></div>
                <div class="form-group"><label>üí∞ Price (‚Çπ)</label><input type="number" id="editProdPrice" placeholder="Price" min="0"></div>
                <div class="form-group"><label>üìÇ Category</label><select id="editProdCategory"><option value="jewelry">Jewelry</option><option value="sarees">Sarees</option><option value="dresses">Dresses</option><option value="accessories">Accessories</option></select></div>
                <div class="form-group"><label>üìÑ Description</label><textarea id="editProdDesc" placeholder="Product description"></textarea></div>
                <div class="form-group"><label>üìÅ Change Image</label><input type="file" id="editProdImage" accept="image/*" onchange="previewEditImage(this)"><div class="image-preview" id="editImagePreview"></div></div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-primary" onclick="saveEditProduct()" style="flex: 1;">üíæ Save Changes</button>
                    <button class="btn-secondary" onclick="cancelEdit()">‚ùå Cancel</button>
                </div>
            </div>

            <h3 style="color: var(--gold); margin: 30px 0 15px 0;">üé® Store Customization</h3>
            <div style="background: var(--primary); padding: 15px; border-radius: 4px; margin-bottom: 20px; border: 1px solid var(--border);">
                <div style="margin-bottom: 20px;">
                    <label style="color: var(--gold); font-weight: 700; display: block; margin-bottom: 10px;">üñºÔ∏è Banner Background Image</label>
                    <input type="file" id="bannerBgImage" accept="image/*" onchange="previewBannerBg(this)">
                    <div class="image-preview" id="bannerBgPreview" style="height: 100px; margin-top: 10px;"></div>
                    <button class="btn-primary" onclick="saveBannerBackground()" style="width: 100%; margin-top: 10px;">üì§ Save Background</button>
                    <button class="btn-secondary" onclick="downloadBannerBg()" style="width: 100%; margin-top: 8px;">‚¨áÔ∏è Download Current</button>
                </div>
                <div style="border-top: 1px solid var(--border); padding-top: 15px;">
                    <label style="color: var(--gold); font-weight: 700; display: block; margin-bottom: 10px;">üè∑Ô∏è Logo/Store Name</label>
                    <input type="file" id="logoImage" accept="image/*" onchange="previewLogo(this)">
                    <div class="image-preview" id="logoPreview" style="height: 100px; width: 100px; margin-top: 10px;"></div>
                    <button class="btn-primary" onclick="saveLogo()" style="width: 100%; margin-top: 10px;">üì§ Save Logo</button>
                    <button class="btn-secondary" onclick="downloadLogo()" style="width: 100%; margin-top: 8px;">‚¨áÔ∏è Download Current</button>
                </div>
            </div>

            <h3 style="color: var(--gold); margin: 30px 0 15px 0;">üìä Current Products</h3>
            <div id="adminProductsList" style="max-height: 500px; overflow-y: auto;"></div>
        </div>
    </div>
</div>

<button class="admin-btn" onclick="openAdminModal()" title="Admin Panel">‚öôÔ∏è</button>

<script>
    const DB_NAME = 'RoyalPerfect';
    const STORE_NAME = 'products';
    const USERS_STORE = 'users';
    const REVIEWS_STORE = 'reviews';
    let db = null;
    let products = [];
    let cart = [];
    let currentProduct = null;
    let currentEditingId = null;
    let currentUser = null;
    const adminPassword = "prakashrosy21";

    function initDB() {
        return new Promise((resolve, reject) => {
            const request = indexedDB.open(DB_NAME, 1);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => { db = request.result; resolve(db); };
            request.onupgradeneeded = (e) => {
                db = e.target.result;
                if (!db.objectStoreNames.contains(STORE_NAME)) db.createObjectStore(STORE_NAME, { keyPath: 'id' });
                if (!db.objectStoreNames.contains(USERS_STORE)) db.createObjectStore(USERS_STORE, { keyPath: 'mobile' });
                if (!db.objectStoreNames.contains(REVIEWS_STORE)) db.createObjectStore(REVIEWS_STORE, { keyPath: 'id', autoIncrement: true });
            };
        });
    }

    function saveProductToDB(product) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([STORE_NAME], 'readwrite');
            const store = transaction.objectStore(STORE_NAME);
            const request = store.put(product);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function getAllProductsFromDB() {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([STORE_NAME], 'readonly');
            const store = transaction.objectStore(STORE_NAME);
            const request = store.getAll();
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function deleteProductFromDB(id) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([STORE_NAME], 'readwrite');
            const store = transaction.objectStore(STORE_NAME);
            const request = store.delete(id);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve();
        });
    }

    function saveReview(review) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([REVIEWS_STORE], 'readwrite');
            const store = transaction.objectStore(REVIEWS_STORE);
            const request = store.add(review);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function getReviewsForProduct(productId) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([REVIEWS_STORE], 'readonly');
            const store = transaction.objectStore(REVIEWS_STORE);
            const request = store.getAll();
            request.onerror = () => reject(request.error);
            request.onsuccess = () => {
                const allReviews = request.result.filter(r => r.productId === productId);
                resolve(allReviews);
            };
        });
    }

    function compressAndConvertImage(file) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    let width = img.width, height = img.height;
                    if (width > 400) { height = (height * 400) / width; width = 400; }
                    canvas.width = width; canvas.height = height;
                    canvas.getContext('2d').drawImage(img, 0, 0, width, height);
                    resolve(canvas.toDataURL('image/jpeg', 0.7));
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        });
    }

    function previewNewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('newImagePreview').style.backgroundImage = `url('${e.target.result}')`;
                document.getElementById('newImagePreview').classList.add('show');
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function previewEditImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('editImagePreview').style.backgroundImage = `url('${e.target.result}')`;
                document.getElementById('editImagePreview').classList.add('show');
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    async function loadProducts() {
        try {
            products = await getAllProductsFromDB();
            if (products.length === 0) {
                const defaultProducts = [
                    {id: 1, name: "Diamond Pendant", price: 4999, category: "jewelry", image: "https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=400&h=400&fit=crop", rating: 4.8, reviews: 150, desc: "Premium diamond pendant with 18K gold setting. Elegant design perfect for any occasion."},
                    {id: 2, name: "Pearl Choker", price: 2999, category: "jewelry", image: "https://images.unsplash.com/photo-1573408301185-9146fe634ad0?w=400&h=400&fit=crop", rating: 4.9, reviews: 200, desc: "Elegant pearl choker necklace. Classic and timeless design for special occasions."},
                    {id: 3, name: "Gold Earrings", price: 1499, category: "jewelry", image: "https://images.unsplash.com/photo-1509941943102-8c5a6b5e2e1e?w=400&h=400&fit=crop", rating: 4.8, reviews: 300, desc: "Beautiful gold earrings with intricate design. Perfect for daily wear or special events."},
                    {id: 4, name: "Bridal Saree", price: 9999, category: "sarees", image: "https://images.unsplash.com/photo-1505252585461-04db1267ae5e?w=400&h=400&fit=crop", rating: 5.0, reviews: 180, desc: "Luxurious bridal saree with traditional embroidery. Perfect for weddings and celebrations."},
                    {id: 5, name: "Evening Gown", price: 5999, category: "dresses", image: "https://images.unsplash.com/photo-1566073771259-6a8506099945?w=400&h=400&fit=crop", rating: 4.9, reviews: 220, desc: "Stunning evening gown with elegant design. Perfect for formal dinners and events."},
                    {id: 6, name: "Luxury Tiara", price: 7999, category: "accessories", image: "https://images.unsplash.com/photo-1535632066927-ab7c9ab60908?w=400&h=400&fit=crop", rating: 4.9, reviews: 250, desc: "Elegant luxury tiara for special occasions. Handcrafted with premium materials."},
                    {id: 7, name: "Crystal Bracelet", price: 2499, category: "accessories", image: "https://images.unsplash.com/photo-1611591437281-460bfbe1220a?w=400&h=400&fit=crop", rating: 4.8, reviews: 280, desc: "Sparkling crystal bracelet with elegant design. Perfect for any outfit."},
                    {id: 8, name: "Designer Ring", price: 3999, category: "jewelry", image: "https://images.unsplash.com/photo-1515562141207-6811bcb33856?w=400&h=400&fit=crop", rating: 4.9, reviews: 150, desc: "Designer ring with unique pattern. Premium craftsmanship and quality."}
                ];
                for (let prod of defaultProducts) await saveProductToDB(prod);
                products = defaultProducts;
            }
            renderProducts(products);
        } catch (err) { console.error('Error loading products:', err); }
    }

    function renderProducts(productsToRender = products) {
        const grid = document.getElementById('productsGrid');
        grid.innerHTML = productsToRender.map(p => `
            <div class="product-item" onclick="viewProductDetail(${p.id})">
                <div class="product-image" style="background-image: url('${p.image}')"></div>
                <div class="product-body">
                    <div class="product-name">${p.name}</div>
                    <div class="product-rating">‚≠ê ${p.rating}/5 (${p.reviews})</div>
                    <div class="product-price">‚Çπ${p.price}</div>
                    <div class="product-buttons">
                        <button class="btn-add-cart" onclick="event.stopPropagation(); addToCartFromHome(${p.id})">Add Cart</button>
                        <button class="btn-buy-now" onclick="event.stopPropagation(); buyNowFromHome(${p.id})">Buy Now</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    async function viewProductDetail(productId) {
        currentProduct = products.find(p => p.id === productId);
        if (!currentProduct) return;

        document.getElementById('detailImage').style.backgroundImage = `url('${currentProduct.image}')`;
        document.getElementById('detailName').textContent = currentProduct.name;
        document.getElementById('detailPrice').textContent = `‚Çπ${currentProduct.price}`;
        document.getElementById('detailTitle').textContent = currentProduct.name;
        document.getElementById('detailCategory').textContent = `Category: ${currentProduct.category.toUpperCase()}`;
        document.getElementById('detailDesc').textContent = currentProduct.desc;
        
        const stars = '‚≠ê'.repeat(Math.round(currentProduct.rating)) + '‚òÜ'.repeat(5 - Math.round(currentProduct.rating));
        document.getElementById('detailStars').textContent = stars;
        document.getElementById('detailReviewCount').textContent = `${currentProduct.reviews} reviews`;

        // Clear review form
        document.getElementById('reviewName').value = '';
        document.getElementById('reviewRating').value = '5';
        document.getElementById('reviewText').value = '';

        await loadReviews(productId);
        showPage('productDetailPage');
    }

    async function loadReviews(productId) {
        try {
            const reviews = await getReviewsForProduct(productId);
            const reviewsList = document.getElementById('reviewsList');
            
            if (reviews.length === 0) {
                reviewsList.innerHTML = '<p style="color: var(--text-secondary); text-align: center; padding: 20px;">No reviews yet. Be the first to review!</p>';
                document.getElementById('avgRating').textContent = '5.0';
                document.getElementById('summaryStars').textContent = '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê';
                document.getElementById('totalReviews').textContent = '0';
                return;
            }

            const avgRating = (reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length).toFixed(1);
            document.getElementById('avgRating').textContent = avgRating;
            document.getElementById('summaryStars').textContent = '‚≠ê'.repeat(Math.round(avgRating)) + '‚òÜ'.repeat(5 - Math.round(avgRating));
            document.getElementById('totalReviews').textContent = reviews.length;

            reviewsList.innerHTML = reviews.map(review => `
                <div class="review-item">
                    <div class="review-header">
                        <span class="reviewer-name">${review.name}</span>
                        <span class="review-date">${new Date(review.date).toLocaleDateString()}</span>
                    </div>
                    <div class="review-stars">${'‚≠ê'.repeat(review.rating)}</div>
                    <div class="review-text">"${review.text}"</div>
                </div>
            `).join('');
        } catch (err) { console.error('Error loading reviews:', err); }
    }

    async function submitReview() {
        const name = document.getElementById('reviewName').value.trim();
        const rating = parseInt(document.getElementById('reviewRating').value);
        const text = document.getElementById('reviewText').value.trim();

        if (!name || !text) { showNotif('‚úó Fill name and review!'); return; }
        if (text.length < 10) { showNotif('‚úó Review must be at least 10 characters!'); return; }

        try {
            const review = {
                productId: currentProduct.id,
                name,
                rating,
                text,
                date: new Date().toISOString()
            };

            await saveReview(review);
            showNotif('‚úì Review posted successfully!');
            
            document.getElementById('reviewName').value = '';
            document.getElementById('reviewRating').value = '5';
            document.getElementById('reviewText').value = '';
            
            await loadReviews(currentProduct.id);
        } catch (err) { showNotif('‚úó Error posting review!'); }
    }

    function searchProducts() {
        const query = document.getElementById('searchBox').value.toLowerCase();
        const filtered = products.filter(p => p.name.toLowerCase().includes(query) || p.desc.toLowerCase().includes(query) || p.category.includes(query));
        renderProducts(filtered);
    }

    function filterByCategory(category) {
        clearFilters();
        if (category === 'all') renderProducts(products);
        else renderProducts(products.filter(p => p.category === category));
    }

    function applyFilters() {
        let filtered = [...products];
        const priceRanges = [];
        if (document.getElementById('price1').checked) priceRanges.push([0, 2000]);
        if (document.getElementById('price2').checked) priceRanges.push([2000, 5000]);
        if (document.getElementById('price3').checked) priceRanges.push([5000, 10000]);
        if (document.getElementById('price4').checked) priceRanges.push([10000, Infinity]);
        if (priceRanges.length > 0) filtered = filtered.filter(p => priceRanges.some(range => p.price >= range[0] && p.price <= range[1]));
        
        const categories = [];
        if (document.getElementById('cat1').checked) categories.push('jewelry');
        if (document.getElementById('cat2').checked) categories.push('sarees');
        if (document.getElementById('cat3').checked) categories.push('dresses');
        if (document.getElementById('cat4').checked) categories.push('accessories');
        if (categories.length > 0) filtered = filtered.filter(p => categories.includes(p.category));
        
        const ratings = [];
        if (document.getElementById('rating5').checked) ratings.push(5);
        if (document.getElementById('rating4').checked) ratings.push(4);
        if (document.getElementById('rating3').checked) ratings.push(3);
        if (ratings.length > 0) filtered = filtered.filter(p => ratings.some(r => Math.round(p.rating) >= r));
        
        renderProducts(filtered);
    }

    function clearFilters() {
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => checkbox.checked = false);
        renderProducts(products);
    }

    function addToCartFromHome(productId) {
        const product = products.find(p => p.id === productId);
        const existing = cart.find(i => i.id === productId);
        if (existing) existing.qty++;
        else cart.push({...product, qty: 1});
        updateCart();
        showNotif('‚úì Added to cart!');
    }

    function addToCart() {
        if (!currentProduct) return;
        const existing = cart.find(i => i.id === currentProduct.id);
        if (existing) existing.qty++;
        else cart.push({...currentProduct, qty: 1});
        updateCart();
        showNotif('‚úì Added to cart!');
    }

    function updateCart() {
        document.getElementById('cartBadge').textContent = cart.reduce((sum, i) => sum + i.qty, 0);
    }

    function buyNowFromHome(productId) {
        const product = products.find(p => p.id === productId);
        const msg = `Hi! I'm interested in ${product.name} (‚Çπ${product.price}). Send me details.`;
        window.open(`https://wa.me/918220390911?text=${encodeURIComponent(msg)}`, '_blank');
    }

    function buyNow() {
        if (!currentProduct) return;
        const msg = `Hi! I'm interested in ${currentProduct.name} (‚Çπ${currentProduct.price}). Send me details.`;
        window.open(`https://wa.me/918220390911?text=${encodeURIComponent(msg)}`, '_blank');
    }

    function openAdminModal() {
        document.getElementById('adminModal').classList.add('active');
        document.getElementById('adminPasswordSection').style.display = 'block';
        document.getElementById('adminContent').style.display = 'none';
        document.getElementById('adminPass').value = '';
    }

    function closeAdminModal() {
        document.getElementById('adminModal').classList.remove('active');
    }

    function verifyAdmin() {
        const password = document.getElementById('adminPass').value;
        if (password === adminPassword) {
            document.getElementById('adminPasswordSection').style.display = 'none';
            document.getElementById('adminContent').style.display = 'block';
            renderAdminProducts();
            showNotif('‚úì Admin access granted!');
        } else showNotif('‚úó Wrong password!');
    }

    async function addProduct() {
        const name = document.getElementById('newProdName').value;
        const price = parseFloat(document.getElementById('newProdPrice').value);
        const category = document.getElementById('newProdCategory').value;
        const desc = document.getElementById('newProdDesc').value;
        const imageFile = document.getElementById('newProdImage').files[0];

        if (!name || !price || !imageFile) { showNotif('‚úó Fill name, price & choose image!'); return; }

        try {
            const compressedImage = await compressAndConvertImage(imageFile);
            const product = {id: Date.now(), name, price, category, image: compressedImage, rating: 5.0, reviews: 0, desc: desc || ''};
            await saveProductToDB(product);
            products.push(product);
            renderProducts();
            renderAdminProducts();
            document.getElementById('newProdName').value = '';
            document.getElementById('newProdPrice').value = '';
            document.getElementById('newProdDesc').value = '';
            document.getElementById('newProdImage').value = '';
            document.getElementById('newImagePreview').classList.remove('show');
            showNotif('‚úì Product added!');
        } catch (err) { showNotif('‚úó Error uploading image!'); }
    }

    async function renderAdminProducts() {
        const list = document.getElementById('adminProductsList');
        list.innerHTML = products.map(p => `
            <div class="admin-product-item">
                <div class="admin-product-image" style="background-image: url('${p.image}')"></div>
                <div class="admin-product-info">
                    <div class="admin-product-name">${p.name}</div>
                    <div class="admin-product-details">üí∞ ‚Çπ${p.price} | üìÇ ${p.category}</div>
                    <div class="admin-product-details">${p.desc ? p.desc : 'No description'}</div>
                    <div class="admin-product-buttons">
                        <button class="btn-edit" onclick="startEditProduct(${p.id})">‚úèÔ∏è Edit</button>
                        <button class="btn-delete" onclick="deleteProduct(${p.id})">üóëÔ∏è Delete</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function startEditProduct(id) {
        const product = products.find(p => p.id === id);
        if (!product) return;
        currentEditingId = id;
        document.getElementById('editProdName').value = product.name;
        document.getElementById('editProdPrice').value = product.price;
        document.getElementById('editProdCategory').value = product.category;
        document.getElementById('editProdDesc').value = product.desc || '';
        const preview = document.getElementById('editImagePreview');
        preview.style.backgroundImage = `url('${product.image}')`;
        preview.classList.add('show');
        document.getElementById('editProductSection').style.display = 'block';
        document.getElementById('adminProductsList').style.display = 'none';
    }

    async function saveEditProduct() {
        const name = document.getElementById('editProdName').value;
        const price = parseFloat(document.getElementById('editProdPrice').value);
        const category = document.getElementById('editProdCategory').value;
        const desc = document.getElementById('editProdDesc').value;
        const imageFile = document.getElementById('editProdImage').files[0];

        if (!name || !price) { showNotif('‚úó Fill name & price!'); return; }

        try {
            const product = products.find(p => p.id === currentEditingId);
            product.name = name; product.price = price; product.category = category; product.desc = desc;
            if (imageFile) product.image = await compressAndConvertImage(imageFile);
            await saveProductToDB(product);
            renderProducts();
            renderAdminProducts();
            cancelEdit();
            showNotif('‚úì Product updated!');
        } catch (err) { showNotif('‚úó Error updating product!'); }
    }

    function cancelEdit() {
        currentEditingId = null;
        document.getElementById('editProductSection').style.display = 'none';
        document.getElementById('adminProductsList').style.display = 'block';
        document.getElementById('editProdImage').value = '';
        document.getElementById('editImagePreview').classList.remove('show');
    }

    async function deleteProduct(id) {
        if (confirm('Are you sure you want to delete this product?')) {
            try {
                await deleteProductFromDB(id);
                products = products.filter(p => p.id !== id);
                renderProducts();
                renderAdminProducts();
                showNotif('‚úì Product deleted!');
            } catch (err) { showNotif('‚úó Error deleting product!'); }
        }
    }

    function goHome() { showPage('homePage'); }

    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
    }

    function showNotif(msg) {
        const div = document.createElement('div');
        div.className = 'notification';
        div.textContent = msg;
        document.body.appendChild(div);
        setTimeout(() => div.remove(), 2500);
    }

    document.addEventListener('click', function(event) {
        if (event.target === document.getElementById('adminModal')) closeAdminModal();
        if (event.target === document.getElementById('userModal')) closeUserPanel();
    });

    function switchTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => { tab.classList.remove('active'); tab.style.display = 'none'; });
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        const selectedTab = document.getElementById(tabName + 'Tab');
        if (selectedTab) { selectedTab.classList.add('active'); selectedTab.style.display = 'block'; }
        const buttons = document.querySelectorAll('.tab-btn');
        for (let btn of buttons) { if (btn.getAttribute('onclick').includes(tabName)) { btn.classList.add('active'); break; } }
    }

    function openUserPanel() {
        document.getElementById('userModal').classList.add('active');
        if (currentUser) {
            switchTab('account');
            loadAccountDetails();
            document.getElementById('authTabs').style.display = 'none';
        } else {
            switchTab('login');
            document.getElementById('authTabs').style.display = 'flex';
        }
    }

    function closeUserPanel() {
        document.getElementById('userModal').classList.remove('active');
    }

    function saveUser(user) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([USERS_STORE], 'readwrite');
            const store = transaction.objectStore(USERS_STORE);
            const request = store.put(user);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function getUser(mobile) {
        return new Promise((resolve, reject) => {
            const transaction = db.transaction([USERS_STORE], 'readonly');
            const store = transaction.objectStore(USERS_STORE);
            const request = store.get(mobile);
            request.onerror = () => reject(request.error);
            request.onsuccess = () => resolve(request.result);
        });
    }

    function signupUser() {
        const name = document.getElementById('signupName').value.trim();
        const mobile = document.getElementById('signupMobile').value.trim();
        const email = document.getElementById('signupEmail').value.trim();
        const password = document.getElementById('signupPassword').value.trim();

        if (!name || !mobile || !password) { showNotif('‚úó Fill all required fields!'); return; }
        if (mobile.length !== 10 || !/^\d+$/.test(mobile)) { showNotif('‚úó Mobile must be 10 digits!'); return; }
        if (password.length < 4) { showNotif('‚úó Password too short!'); return; }

        getUser(mobile).then(existingUser => {
            if (existingUser) { showNotif('‚úó Mobile number already registered!'); return; }
            const newUser = {mobile, name, email, password, address: '', city: '', state: '', pincode: '', country: 'India', createdAt: new Date().toISOString()};
            saveUser(newUser).then(() => {
                persistLogin(newUser);
                showNotif('‚úì Account created successfully!');
                document.getElementById('signupName').value = '';
                document.getElementById('signupMobile').value = '';
                document.getElementById('signupEmail').value = '';
                document.getElementById('signupPassword').value = '';
                document.getElementById('authTabs').style.display = 'none';
                switchTab('account');
                loadAccountDetails();
            }).catch(err => { console.error("Signup error:", err); showNotif('‚úó Error saving account!'); });
        });
    }

    function loginUser() {
        const mobile = document.getElementById('loginMobile').value.trim();
        const password = document.getElementById('loginPassword').value.trim();

        if (!mobile || !password) { showNotif('‚úó Enter mobile & password!'); return; }

        getUser(mobile).then(user => {
            if (!user) { showNotif('‚úó Account not found!'); return; }
            if (user.password !== password) { showNotif('‚úó Wrong password!'); return; }
            persistLogin(user);
            showNotif('‚úì Logged in successfully!');
            document.getElementById('loginMobile').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('authTabs').style.display = 'none';
            switchTab('account');
            loadAccountDetails();
        });
    }

    function persistLogin(user) {
        currentUser = user;
        localStorage.setItem('currentUserMobile', user.mobile);
        updateUserLink();
    }

    function loadAccountDetails() {
        if (!currentUser) return;
        document.getElementById('accountName').textContent = currentUser.name;
        document.getElementById('accountMobile').textContent = `üì± ${currentUser.mobile}`;
        document.getElementById('accountAddress').value = currentUser.address || '';
        document.getElementById('accountCity').value = currentUser.city || '';
        document.getElementById('accountState').value = currentUser.state || '';
        document.getElementById('accountPincode').value = currentUser.pincode || '';
        document.getElementById('accountCountry').value = currentUser.country || 'India';
    }

    function saveAccountDetails() {
        if (!currentUser) return;
        currentUser.address = document.getElementById('accountAddress').value;
        currentUser.city = document.getElementById('accountCity').value;
        currentUser.state = document.getElementById('accountState').value;
        currentUser.pincode = document.getElementById('accountPincode').value;
        currentUser.country = document.getElementById('accountCountry').value;
        saveUser(currentUser).then(() => showNotif('‚úì Details saved successfully!'));
    }

    function logoutUser() {
        currentUser = null;
        localStorage.removeItem('currentUserMobile');
        updateUserLink();
        closeUserPanel();
        showNotif('‚úì Logged out successfully!');
    }

    function updateUserLink() {
        const link = document.getElementById('userLink');
        if (currentUser) link.textContent = `üë§ ${currentUser.name.split(' ')[0]}`;
        else link.textContent = 'üë§ Sign In';
    }

    function checkLoginStatus() {
        const storedMobile = localStorage.getItem('currentUserMobile');
        if (storedMobile) {
            const checkInterval = setInterval(() => {
                if (db) {
                    clearInterval(checkInterval);
                    getUser(storedMobile).then(user => {
                        if (user) { currentUser = user; updateUserLink(); console.log("Session restored for:", user.name); }
                    });
                }
            }, 100);
        }
    }

    function previewBannerBg(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('bannerBgPreview').style.backgroundImage = `url('${e.target.result}')`;
                document.getElementById('bannerBgPreview').classList.add('show');
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function previewLogo(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('logoPreview').style.backgroundImage = `url('${e.target.result}')`;
                document.getElementById('logoPreview').classList.add('show');
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    async function saveBannerBackground() {
        const file = document.getElementById('bannerBgImage').files[0];
        if (!file) { showNotif('‚úó Select an image!'); return; }
        try {
            const compressedImage = await compressAndConvertImage(file);
            localStorage.setItem('bannerBg', compressedImage);
            applyBannerBackground(compressedImage);
            showNotif('‚úì Banner background saved!');
        } catch (err) { showNotif('‚úó Error saving background!'); }
    }

    async function saveLogo() {
        const file = document.getElementById('logoImage').files[0];
        if (!file) { showNotif('‚úó Select a logo image!'); return; }
        try {
            const compressedImage = await compressAndConvertImage(file);
            localStorage.setItem('logoImage', compressedImage);
            applyLogo(compressedImage);
            showNotif('‚úì Logo saved!');
        } catch (err) { showNotif('‚úó Error saving logo!'); }
    }

    function applyBannerBackground(imageUrl) {
        document.querySelector('.banner').style.backgroundImage = `url('${imageUrl}')`;
        document.querySelector('.banner').style.backgroundSize = 'cover';
        document.querySelector('.banner').style.backgroundPosition = 'center';
    }

    function applyLogo(imageUrl) {
        document.querySelector('.logo-img').src = imageUrl;
    }

    function downloadBannerBg() {
        const bannerBg = localStorage.getItem('bannerBg');
        if (!bannerBg) { showNotif('‚úó No banner background saved!'); return; }
        downloadImage(bannerBg, 'royal-perfect-banner.jpg');
    }

    function downloadLogo() {
        const logo = localStorage.getItem('logoImage');
        if (!logo) { showNotif('‚úó No logo saved!'); return; }
        downloadImage(logo, 'royal-perfect-logo.jpg');
    }

    function downloadImage(dataUrl, filename) {
        const link = document.createElement('a');
        link.href = dataUrl;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    function loadStoredAssets() {
        const bannerBg = localStorage.getItem('bannerBg');
        if (bannerBg) applyBannerBackground(bannerBg);
        const logo = localStorage.getItem('logoImage');
        if (logo) applyLogo(logo);
    }

    initDB().then(() => {
        loadProducts();
        loadStoredAssets();
        checkLoginStatus();
    });
</script>

</body>
</html>